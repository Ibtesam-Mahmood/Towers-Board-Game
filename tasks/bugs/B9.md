### B9 - Units are unable to attack

**Description:** When a unit goes to attack/move and presses on an enemy unit highlighted in red, they are not able to attack and the combat menu does not launch.
**Expected Result:** When a unit attacks another unit the combat menu should launch.
**Files Affected:** 
- `lib/enhanced-game-logic.ts` - Fixed getValidAttackTargets function
- `components/enhanced-immersive-game-interface.tsx` - Added enhanced debugging and improved attack logic

**Subtasks:**

- [X] Identify combat menu launch condition detection logic
- [X] Identify unit attack logic
- [X] Find missing logic to launch combat menu when unit attacks
- [X] Implement a fix to launch the combat menu when the unit attacks

**Requirements Impact:** None - fixing existing combat access
**Completion Notes:** 
- **Root Cause:** The `getValidAttackTargets` function in `enhanced-game-logic.ts` was using an `else if` condition that prevented units with both melee and ranged capabilities from attacking at ranges other than adjacent. This caused units like archers (who have both melee 1 and ranged 4) to be unable to attack at range.
- **Additional Issue:** Combat menu was disappearing when clicking away from units due to state clearing logic.
- **Solution:** 
  1. Fixed the logic in `getValidAttackTargets` to use separate conditions for melee and ranged attacks, allowing units to attack using either capability based on distance
  2. Improved combat menu persistence by preventing unit selection clearing when combat menu is active
  3. Cleaned up debugging code and improved error handling
- **Testing:** Combat menu now properly launches when clicking on enemy units within attack range and includes proper "Cancel" and "ROLL FOR COMBAT!" buttons for user confirmation
- **Files Modified:** 
  - `lib/enhanced-game-logic.ts` - Fixed attack target validation logic and cleaned up debugging
  - `components/enhanced-immersive-game-interface.tsx` - Improved combat flow and menu persistence
